image: "node:10.15.0"

stage:
  - build

default:
  before_script:
    - node --version
    - yarn --version
    - npm --version
    - npm install -g @vue/cli
    - npm install -g firebase-tools
    - yarn
    - cd functions
    - npm install
    - cd ..

build_and_deploy:
  stage: build
  script: 
    - npm run build
    - firebase use --token $FIREBASE_TOKEN production
    - firebase deploy -m "Pipeline $CI_PIPELINE_ID, build $CI_BUILD_ID" --non-interactive --token "$FIREBASE_TOKEN"
